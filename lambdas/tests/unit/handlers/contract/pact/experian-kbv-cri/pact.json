{
    "consumer": {
        "name": "IpvCoreBack"
    },
    "interactions": [
        {
            "_id": "bf43a57c9fe291f7df6196b454b6ec8473bd3a5a",
            "description": "Valid auth code",
            "providerStates": [
                {
                    "name": "dummyAuthCode is a valid authorization code"
                },
                {
                    "name": "dummyApiKey is a valid api key"
                },
                {
                    "name": "dummyExperianKbvComponentId is the experianKbv CRI component ID"
                },
                {
                    "name": "ExperianKbv CRI uses CORE_BACK_SIGNING_PRIVATE_KEY_JWK to validate core signatures"
                }
            ],
            "request": {
                "body": "client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer&code=dummyAuthCode&grant_type=authorization_code&redirect_uri=https%3A%2F%2Fidentity.staging.account.gov.uk%2Fcredential-issuer%2Fcallback%3Fid%3Dkbv&client_assertion=eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NiJ9.eyJpc3MiOiJpcHYtY29yZSIsInN1YiI6Imlwdi1jb3JlIiwiYXVkIjoiZHVtbXlFeHBlcmlhbktidkNvbXBvbmVudElkIiwiZXhwIjo0MDcwOTA5NzAwLCJqdGkiOiJTY25GNGRHWHRoWllYU181azg1T2JFb1NVMDRXLUgzcWFfcDZucHYyWlVZIn0.aJOEpvnBRpaptv_2T7L5aCzhTdvlNaGNh3uwuK1f5cC9he9izuIr60s2_Y6-DIPEWLE0_L6ckgdIsy9G7yj8jA",
                "headers": {
                    "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
                    "x-api-key": "dummyApiKey"
                },
                "method": "POST",
                "path": "/token"
            },
            "response": {
                "body": {
                    "access_token": "string",
                    "expires_in": 100,
                    "token_type": "Bearer"
                },
                "generators": {
                    "body": {
                        "$.access_token": {
                            "size": 20,
                            "type": "RandomString"
                        },
                        "$.expires_in": {
                            "max": 2147483647,
                            "min": 0,
                            "type": "RandomInt"
                        }
                    }
                },
                "headers": {
                    "Content-Type": "application/json; charset=UTF-8"
                },
                "matchingRules": {
                    "body": {
                        "$.access_token": {
                            "combine": "AND",
                            "matchers": [
                                {
                                    "match": "type"
                                }
                            ]
                        },
                        "$.expires_in": {
                            "combine": "AND",
                            "matchers": [
                                {
                                    "match": "integer"
                                }
                            ]
                        }
                    },
                    "header": {
                        "Content-Type": {
                            "combine": "AND",
                            "matchers": [
                                {
                                    "match": "regex",
                                    "regex": "application/json(;\\s?charset=[\\w\\-]+)?"
                                }
                            ]
                        }
                    }
                },
                "status": 200
            }
        },
        {
            "_id": "d1ce88dee3ce11e998c0a39da0ed469250d5b132",
            "description": "Invalid authorization code",
            "providerStates": [
                {
                    "name": "dummyInvalidAuthCode is an invalid authorization code"
                },
                {
                    "name": "dummyApiKey is a valid api key"
                },
                {
                    "name": "dummyExperianKbvComponentId is the experianKbv CRI component ID"
                },
                {
                    "name": "ExperianKbv CRI uses CORE_BACK_SIGNING_PRIVATE_KEY_JWK to validate core signatures"
                }
            ],
            "request": {
                "body": "client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer&code=dummyInvalidAuthCode&grant_type=authorization_code&redirect_uri=https%3A%2F%2Fidentity.staging.account.gov.uk%2Fcredential-issuer%2Fcallback%3Fid%3Dkbv&client_assertion=eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NiJ9.eyJpc3MiOiJpcHYtY29yZSIsInN1YiI6Imlwdi1jb3JlIiwiYXVkIjoiZHVtbXlFeHBlcmlhbktidkNvbXBvbmVudElkIiwiZXhwIjo0MDcwOTA5NzAwLCJqdGkiOiJTY25GNGRHWHRoWllYU181azg1T2JFb1NVMDRXLUgzcWFfcDZucHYyWlVZIn0.aJOEpvnBRpaptv_2T7L5aCzhTdvlNaGNh3uwuK1f5cC9he9izuIr60s2_Y6-DIPEWLE0_L6ckgdIsy9G7yj8jA",
                "headers": {
                    "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
                    "x-api-key": "dummyApiKey"
                },
                "method": "POST",
                "path": "/token"
            },
            "response": {
                "status": 400
            }
        }
    ],
    "metadata": {
        "pact-jvm": {
            "version": "4.6.5"
        },
        "pactSpecification": {
            "version": "3.0.0"
        }
    },
    "provider": {
        "name": "ExperianKbvCriTokenProvider"
    },
    "createdAt": "2024-09-05T15:03:06+00:00"
}
