{
    "consumer": {
        "name": "IpvCoreBack"
    },
    "interactions": [
        {
            "_id": "7a35e0d877a7a94cdd925dce909401871edfc472",
            "description": "Valid auth code",
            "providerStates": [
                {
                    "name": "dummyAuthCode is a valid authorization code"
                },
                {
                    "name": "dummyApiKey is a valid api key"
                },
                {
                    "name": "dummyNinoComponentId is the NINO CRI component ID"
                },
                {
                    "name": "NINO CRI uses CORE_BACK_SIGNING_PRIVATE_KEY_JWK to validate core signatures"
                }
            ],
            "request": {
                "body": "client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer&code=dummyAuthCode&grant_type=authorization_code&redirect_uri=https%3A%2F%2Fidentity.staging.account.gov.uk%2Fcredential-issuer%2Fcallback%3Fid%3Dnino&client_assertion=eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NiJ9.eyJpc3MiOiJpcHYtY29yZSIsInN1YiI6Imlwdi1jb3JlIiwiYXVkIjoiZHVtbXlOaW5vQ29tcG9uZW50SWQiLCJleHAiOjQwNzA5MDk3MDAsImp0aSI6IlNjbkY0ZEdYdGhaWVhTXzVrODVPYkVvU1UwNFctSDNxYV9wNm5wdjJaVVkifQ.ZHj3_BoW2CJEsWA7i_Eq0tfi3HsmoHonHVmBaY7OAzOn-ZA_MYcIaRuMOCipK4_Ar1hCT1LMYveJrD0aYs1y0Q",
                "headers": {
                    "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
                    "x-api-key": "dummyApiKey"
                },
                "method": "POST",
                "path": "/token"
            },
            "response": {
                "body": {
                    "access_token": "string",
                    "expires_in": 100,
                    "token_type": "Bearer"
                },
                "generators": {
                    "body": {
                        "$.access_token": {
                            "size": 20,
                            "type": "RandomString"
                        },
                        "$.expires_in": {
                            "max": 2147483647,
                            "min": 0,
                            "type": "RandomInt"
                        }
                    }
                },
                "headers": {
                    "Content-Type": "application/json; charset=UTF-8"
                },
                "matchingRules": {
                    "body": {
                        "$.access_token": {
                            "combine": "AND",
                            "matchers": [
                                {
                                    "match": "type"
                                }
                            ]
                        },
                        "$.expires_in": {
                            "combine": "AND",
                            "matchers": [
                                {
                                    "match": "integer"
                                }
                            ]
                        }
                    },
                    "header": {
                        "Content-Type": {
                            "combine": "AND",
                            "matchers": [
                                {
                                    "match": "regex",
                                    "regex": "application/json(;\\s?charset=[\\w\\-]+)?"
                                }
                            ]
                        }
                    }
                },
                "status": 200
            }
        },
        {
            "_id": "335c2273f4c5d44b3d9f80109641da830a87fb79",
            "description": "Invalid auth code",
            "providerStates": [
                {
                    "name": "dummyInvalidAuthCode is an invalid authorization code"
                },
                {
                    "name": "dummyApiKey is a valid api key"
                },
                {
                    "name": "dummyNinoComponentId is the NINO CRI component ID"
                },
                {
                    "name": "NINO CRI uses CORE_BACK_SIGNING_PRIVATE_KEY_JWK to validate core signatures"
                }
            ],
            "request": {
                "body": "client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer&code=dummyInvalidAuthCode&grant_type=authorization_code&redirect_uri=https%3A%2F%2Fidentity.staging.account.gov.uk%2Fcredential-issuer%2Fcallback%3Fid%3Dnino&client_assertion=eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NiJ9.eyJpc3MiOiJpcHYtY29yZSIsInN1YiI6Imlwdi1jb3JlIiwiYXVkIjoiZHVtbXlOaW5vQ29tcG9uZW50SWQiLCJleHAiOjQwNzA5MDk3MDAsImp0aSI6IlNjbkY0ZEdYdGhaWVhTXzVrODVPYkVvU1UwNFctSDNxYV9wNm5wdjJaVVkifQ.ZHj3_BoW2CJEsWA7i_Eq0tfi3HsmoHonHVmBaY7OAzOn-ZA_MYcIaRuMOCipK4_Ar1hCT1LMYveJrD0aYs1y0Q",
                "headers": {
                    "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
                    "x-api-key": "dummyApiKey"
                },
                "method": "POST",
                "path": "/token"
            },
            "response": {
                "status": 403
            }
        }
    ],
    "metadata": {
        "pact-jvm": {
            "version": "4.6.5"
        },
        "pactSpecification": {
            "version": "3.0.0"
        }
    },
    "provider": {
        "name": "NinoCriTokenProvider"
    },
    "createdAt": "2024-09-09T09:44:11+00:00"
}
